<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="The Sono Wolf">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#990000">
    <title>The Sono Wolf - Stony Brook Ultrasound Portal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: none !important;
            animation: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-radius: 0 !important;
            backdrop-filter: none !important;
            filter: none !important;
        }

        /* Exception for spinner only */
        .spinner {
            animation: spin 1s linear infinite !important;
        }

        @keyframes spin {
            0% { transform: rotate(0deg) !important; }
            100% { transform: rotate(360deg) !important; }
        }

        body {
            font-family: 'Courier New', monospace;
            line-height: 1.4;
            color: #000000;
            background: #BEBEBE;
            background-image: 
                radial-gradient(circle at 25% 25%, #39BFC9 2px, transparent 2px),
                radial-gradient(circle at 75% 75%, #990000 1px, transparent 1px);
            background-size: 50px 50px;
            min-height: 100vh;
            min-height: -webkit-fill-available;
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
            position: relative;
        }

        html {
            height: -webkit-fill-available;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: env(safe-area-inset-top, 20px) env(safe-area-inset-right, 20px) env(safe-area-inset-bottom, 20px) env(safe-area-inset-left, 20px);
            padding-top: max(env(safe-area-inset-top), 20px);
        }

        /* Prevent zoom on iOS */
        input, select, textarea {
            font-size: 16px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            background: #39BFC9;
            padding: 20px;
            border: 4px solid #000000;
            border-style: outset;
            box-shadow: 4px 4px 0px #4B4B4B;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 8px;
            color: #990000;
            font-family: 'Impact', 'Arial Black', sans-serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 0px #000000;
        }

        .subtitle {
            font-size: 1rem;
            color: #000000;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .search-container {
            margin-bottom: 20px;
            text-align: center;
            padding: 0 10px;
        }

        .search-box {
            width: 100%;
            max-width: 500px;
            padding: 8px 15px;
            font-size: 16px;
            border: 3px solid #000000;
            border-style: inset;
            background: #BEBEBE;
            color: #000000;
            outline: none;
            -webkit-appearance: none;
            touch-action: manipulation;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }

        .search-box:focus {
            background: #39BFC9;
            border-style: outset;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .category-card {
            background: #828282;
            border: 3px solid #000000;
            border-style: outset;
            padding: 18px;
            box-shadow: 3px 3px 0px #4B4B4B;
            touch-action: manipulation;
        }

        .category-card:hover {
            border-style: inset;
            box-shadow: 1px 1px 0px #4B4B4B;
        }

        .category-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #990000;
            border-bottom: 2px solid #000000;
            padding-bottom: 8px;
            font-family: 'Impact', 'Arial Black', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .category-subheader {
            font-family: 'Courier New', monospace;
            color: #990000;
            font-size: 0.9rem;
            margin: 15px 0 8px 0;
            text-transform: uppercase;
            border-bottom: 1px solid #4B4B4B;
            font-weight: bold;
        }

        .video-link {
            display: block;
            text-decoration: none;
            color: #000000;
            background: #BEBEBE;
            margin-bottom: 6px;
            padding: 8px 12px;
            border: 2px solid #000000;
            border-style: outset;
            font-weight: bold;
            cursor: pointer;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            font-size: 12px;
            min-height: 44px;
            display: flex;
            align-items: center;
            font-family: 'Courier New', monospace;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .video-link:hover, .video-link:active, .video-link:focus {
            background: #39BFC9;
            border-style: inset;
            color: #000000;
        }

        .video-count {
            background: #990000;
            color: #BEBEBE;
            font-size: 0.8rem;
            padding: 2px 6px;
            border: 1px solid #000000;
            margin-left: 10px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .categories-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            h1 {
                font-size: 1.6rem;
            }
            
            .category-card {
                padding: 15px;
            }

            .container {
                padding: env(safe-area-inset-top, 10px) env(safe-area-inset-right, 15px) env(safe-area-inset-bottom, 10px) env(safe-area-inset-left, 15px);
            }

            .video-link {
                font-size: 11px;
            }
        }

        /* iPhone X and newer specific */
        @supports (padding: max(0px)) {
            .container {
                padding-top: max(env(safe-area-inset-top), 20px);
            }
        }

        /* Hide scrollbars but keep functionality on mobile */
        @media (max-width: 768px) {
            ::-webkit-scrollbar {
                display: none;
            }
            
            * {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
        }

        /* Prevent pull-to-refresh */
        @media (max-width: 768px) {
            body {
                overscroll-behavior-y: none;
                -webkit-overflow-scrolling: touch;
            }
        }

        /* Footer styling */
        footer {
            text-align: center;
            padding: 20px;
            background: #828282;
            border: 2px solid #000000;
            border-style: inset;
            margin: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            color: #000000;
        }

        @media (min-width: 860px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
        }

        @media (min-width: 1240px) {
            h1 {
                font-size: 2.5rem;
            }
            
            .subtitle {
                font-size: 1.2rem;
            }
        }

         /* Widget Container */
        .zine-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            z-index: 9999;
            font-family: 'Courier New', monospace;
            transition: none !important;
            animation: none !important;
        }

        /* Toggle Button */
        .zine-toggle {
            width: 60px;
            height: 60px;
            background: #39BFC9;
            border: 4px solid #000000;
            border-style: outset;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: #000000;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 4px 4px 0px #4B4B4B;
            user-select: none;
            text-align: center;
            line-height: 1.1;
        }

        .zine-toggle:hover {
            border-style: inset;
            box-shadow: 2px 2px 0px #4B4B4B;
        }

        .zine-toggle:active {
            border-style: inset;
            box-shadow: 1px 1px 0px #4B4B4B;
        }

        /* Expanded Panel */
        .zine-panel {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 350px;
            height: 500px;
            background: #BEBEBE;
            border: 4px solid #000000;
            border-style: outset;
            box-shadow: 4px 4px 0px #4B4B4B;
            display: none;
            overflow: hidden;
        }

        .zine-panel.expanded {
            display: block;
        }

        /* Header */
        .zine-header {
            background: #39BFC9;
            padding: 10px;
            border-bottom: 2px solid #000000;
            text-align: center;
        }

        .zine-title {
            font-size: 14px;
            font-weight: bold;
            color: #990000;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .zine-subtitle {
            font-size: 10px;
            color: #000000;
            font-weight: bold;
        }

        /* Content Area */
        .zine-content {
            height: calc(100% - 80px);
            overflow-y: auto;
            padding: 10px;
        }

        /* Module Selection */
        .module-category {
            background: #828282;
            border: 2px solid #000000;
            border-style: inset;
            margin-bottom: 10px;
            padding: 8px;
        }

        .category-title {
            font-size: 11px;
            font-weight: bold;
            color: #990000;
            text-transform: uppercase;
            margin-bottom: 8px;
            border-bottom: 1px solid #4B4B4B;
            padding-bottom: 3px;
        }

        .module-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 9px;
        }

        .module-name {
            flex: 1;
            color: #000000;
            font-weight: bold;
        }

        .module-pages {
            background: #990000;
            color: #BEBEBE;
            padding: 1px 4px;
            border: 1px solid #000000;
            margin: 0 5px;
            font-size: 8px;
        }

        .module-btn {
            width: 20px;
            height: 20px;
            background: #39BFC9;
            border: 2px solid #000000;
            border-style: outset;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: #000000;
        }

        .module-btn:hover {
            border-style: inset;
        }

        .module-btn.added {
            background: #990000;
            color: #BEBEBE;
        }

        /* Selected Modules */
        .selected-section {
            background: #828282;
            border: 2px solid #000000;
            border-style: inset;
            padding: 8px;
            margin-bottom: 10px;
        }

        .selected-title {
            font-size: 11px;
            font-weight: bold;
            color: #990000;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .selected-item {
            display: flex;
            align-items: center;
            justify-content: between;
            margin-bottom: 3px;
            font-size: 9px;
            background: #BEBEBE;
            padding: 3px 5px;
            border: 1px solid #000000;
        }

        .selected-name {
            flex: 1;
            color: #000000;
            font-weight: bold;
        }

        .remove-btn {
            width: 15px;
            height: 15px;
            background: #990000;
            color: #BEBEBE;
            border: 1px solid #000000;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            font-weight: bold;
        }

        /* Export Buttons */
        .export-section {
            background: #828282;
            border: 2px solid #000000;
            border-style: inset;
            padding: 8px;
        }

        .export-btn {
            width: 100%;
            padding: 8px;
            margin-bottom: 5px;
            background: #39BFC9;
            border: 2px solid #000000;
            border-style: outset;
            cursor: pointer;
            font-size: 9px;
            font-weight: bold;
            color: #000000;
            text-transform: uppercase;
        }

        .export-btn:hover {
            border-style: inset;
        }

        .export-btn.disabled {
            background: #4B4B4B;
            color: #828282;
            cursor: not-allowed;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .zine-widget {
                bottom: 15px;
                right: 15px;
            }
            
            .zine-panel {
                width: calc(100vw - 30px);
                height: calc(100vh - 100px);
                right: -15px;
                bottom: -15px;
            }
        }

        /* Close button */
        .close-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            background: #990000;
            color: #BEBEBE;
            border: 2px solid #000000;
            border-style: outset;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .close-btn:hover {
            border-style: inset;
        }

        /* Scrollbar styling */
        .zine-content::-webkit-scrollbar {
            width: 8px;
        }

        .zine-content::-webkit-scrollbar-track {
            background: #4B4B4B;
            border: 1px solid #000000;
        }

        .zine-content::-webkit-scrollbar-thumb {
            background: #39BFC9;
            border: 1px solid #000000;
        }

        .zine-content::-webkit-scrollbar-thumb:hover {
            background: #990000;
        }
        
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>The Sono Wolf</h1>
            <p class="subtitle">An Ultrasound Education Portal</p>
        </header>

        <div class="search-container">
            <input type="text" class="search-box" placeholder="Search by topic..." id="searchBox">
        </div>

        <div class="categories-grid" id="categoriesGrid">
            <!-- Basics Category -->
            <div class="category-card" data-category="basics">
                <h2 class="category-title">Basics <span class="video-count">5</span></h2>
                
                <h3 class="category-subheader">Videos</h3>
                <a href="https://coreultrasound.com/knobology/" class="video-link" target="_blank">Knobology</a>
                <a href="https://coreultrasound.com/basic_physics/" class="video-link" target="_blank">Basic Ultrasound Physics</a>
                <a href="https://coreultrasound.com/artifacts_1/" class="video-link" target="_blank">Ultrasound Artifacts, Part 1</a>
                <a href="https://coreultrasound.com/artifacts_2/" class="video-link" target="_blank">Ultrasound Artifacts, Part 2 </a>
                <a href="https://coreultrasound.com/5ms_machinedecon/" class="video-link" target="_blank">Machine Decontamination</a>
            </div>

            <!-- Cardiac Category -->
            <div class="category-card" data-category="cardiac">
                <h2 class="category-title">Cardiac <span class="video-count">7</span></h2>
                
                <h3 class="category-subheader">Anatomy</h3>
                <a href="https://img.grepmed.com/uploads/1464/orientations-atlas-table-anatomy-cardiology-84-original.jpeg" class="video-link" target="_blank">Labeled Anatomy</a>
                <a href="https://images.squarespace-cdn.com/content/v1/58118909e3df282037abfad7/1533340837831-96B9SO0G3BZYRAU7H8F6/subxi+normal+2.gif?format=750w" class="video-link" target="_blank">Subxiphoid View</a>
                <a href="https://images.squarespace-cdn.com/content/v1/58118909e3df282037abfad7/1515618754085-8GLR2N3BJNYT4C9SUCSY/ezgif.com-optimize+%2816%29.gif?format=750w" class="video-link" target="_blank">IVC View</a>
                <a href="https://images.squarespace-cdn.com/content/v1/58118909e3df282037abfad7/1625940717777-5S50RX08LBAOZPSET7G7/image-asset.gif?format=1000w" class="video-link" target="_blank">Parasternal Long Axis</a>
                <a href="https://images.squarespace-cdn.com/content/v1/58118909e3df282037abfad7/1533340807311-EOLBMG24ZZ8FW4CUSBY7/parasternal+short+mitral+normal.gif?format=750w" class="video-link" target="_blank">Parasternal Short Axis</a>
                <a href="https://images.squarespace-cdn.com/content/v1/58118909e3df282037abfad7/1515767891946-8YMWL433EEP1M0B2L427/ezgif.com-gif-maker+%283%29.gif?format=750w" class="video-link" target="_blank">High Parasternal Short</a>
                <a href="https://images.squarespace-cdn.com/content/v1/58118909e3df282037abfad7/1533340761896-F7CB7JOJRV4HKYLFYT5E/apical+4+normal.gif?format=750w" class="video-link" target="_blank">Apical 4 Chamber</a>
                <a href="https://images.squarespace-cdn.com/content/v1/58118909e3df282037abfad7/1533340735596-NXETNR654CKDAUXS3RD9/apical+5+normal.gif?format=750w" class="video-link" target="_blank">Apical 5 Chamber</a>
                
                <h3 class="category-subheader">Scanning Protocols</h3>
                <a href="https://www.showmethepocus.com/planes-and-cardiac-windows" class="video-link" target="_blank">Cardiac Windows</a>
                <a href="https://onlinelibrary.wiley.com/doi/epdf/10.1111/acem.12652" class="video-link" target="_blank">5 E's Cardiac Ultrasound Article</a>
                <a href="#" class="video-link" onclick="show5EsTable(event)">5 E's Table</a>
                
                <h3 class="category-subheader">Clinical Applications</h3>
                <a href="https://medchiefs.bsd.uchicago.edu/files/2014/11/IVCfluidresponsiveness.pdf" class="video-link" target="_blank">IVC Collapsibility / Distensibility</a>
                <a href="https://www.totalem.org/uploads/8/1/8/8/81889406/wall-motion-abnormality_orig.gif" class="video-link" target="_blank">Wall Motion Abnormalities</a>
                <a href="https://www.acep.org/siteassets/sites/ultrasound/media/article-images/advanced-echo-pocket-card/echo.card.fig.2.jpg" class="video-link" target="_blank">Wall Motion Abnormality with EKG Correlation</a>
                
                <h3 class="category-subheader">Videos</h3>
                <a href="https://coreultrasound.com/how-to-obtain-cardiac-windows/" class="video-link" target="_blank">How to Obtain Cardiac Windows</a>
                <a href="https://coreultrasound.com/basic-cardiac-function/" class="video-link" target="_blank">Basic Cardiac Function</a>
                <a href="https://coreultrasound.com/ivc/" class="video-link" target="_blank">IVC</a>

                <h3 class="category-subheader">TEE</h3>
                <a href="https://pie.med.utoronto.ca/TEE/TEE_content/assets/applications/standardViewsHTML5/TEE-HTML5-SV/index.html" class="video-link" target="_blank">Views and Anatomy</a>            
            </div>

            <!-- Lung Category -->
            <div class="category-card" data-category="lung">
                <h2 class="category-title">Lung <span class="video-count">10</span></h2>
                
                <h3 class="category-subheader">Anatomy</h3>
                <a href="https://ars.els-cdn.com/content/image/1-s2.0-S0363018816301281-gr2_lrg.jpg" class="video-link" target="_blank">Lung Anatomy Diagram</a>
                
                <h3 class="category-subheader">Scanning Protocols</h3>
                <a href="https://famus.org.uk/wp-content/uploads/sites/6/BLUE-protocol-schematic-1-1536x850.jpg" class="video-link" target="_blank">BLUE Protocol</a>
                <a href="https://www.nysora.com/wp-content/uploads/2023/05/unnamed-3-1252x1536.jpg" class="video-link" target="_blank">BLUE Protocol Findings</a>
                
                <h3 class="category-subheader">Clinical Applications</h3>
                <a href="https://nephropocus.com/2019/12/03/the-shred-sign/" class="video-link" target="_blank">The Shred Sign</a>
                <a href="https://i0.wp.com/nephropocus.com/wp-content/uploads/2021/11/PEf.gif?ssl=1" class="video-link" target="_blank">The Spine Sign</a>
                
                <h3 class="category-subheader">Videos</h3>
                <a href="https://coreultrasound.com/how-to-perform-a-pulmonary-exam/" class="video-link" target="_blank">How to Perform a Pulmonary Exam</a>
                <a href="https://coreultrasound.com/b-lines/" class="video-link" target="_blank">B-lines</a>
                <a href="https://coreultrasound.com/pneumothorax/" class="video-link" target="_blank">Pneumothorax</a>
                <a href="https://coreultrasound.com/pleural-effusions-part-1/" class="video-link" target="_blank">Pleural Effusion, Part 1</a>
                <a href="https://coreultrasound.com/pleural-effusions-part-2/" class="video-link" target="_blank">Pleural Effusion, Part 2</a>
                <a href="https://coreultrasound.com/pneumonia/" class="video-link" target="_blank">Pneumonia</a>
            </div>

            <!-- Protocols Category -->
            <div class="category-card" data-category="protocols">
                <h2 class="category-title">Protocols <span class="video-count">6</span></h2>
                
                <h3 class="category-subheader">Resources</h3>
                <a href="https://onlinelibrary.wiley.com/doi/10.1155/2012/503254" class="video-link" target="_blank">RUSH Journal Article</a>
                <a href="#" class="video-link" onclick="showRushTable(event)">RUSH Protocol Table</a>
                
                <h3 class="category-subheader">Videos</h3>
                <a href="https://coreultrasound.com/rush-exam/" class="video-link" target="_blank">RUSH exam</a>
                <a href="https://coreultrasound.com/efast/" class="video-link" target="_blank">EFAST exam</a>
                <a href="https://www.showmethepocus.com/five-standard-views-cardiac-ultrasound" class="video-link" target="_blank">The 5 E's</a>
            </div>

            <!-- Genitourinary Category -->
            <div class="category-card" data-category="genitourinary">
                <h2 class="category-title">Genitourinary <span class="video-count">2</span></h2>
                
                <h3 class="category-subheader">Scanning Protocols</h3>
                <a href="https://www.pocus101.com/renal-ultrasound-made-easy-step-by-step-guide/#Step-by-Step_Renal_Ultrasound_Protocol" class="video-link" target="_blank">Renal Ultrasound</a>
                
                <h3 class="category-subheader">Videos</h3>
                <a href="https://coreultrasound.com/bladder-volume-measurement/" class="video-link" target="_blank">Bladder Volume Measurement</a>
            </div>

            <!-- Gastrointestinal Category -->
            <div class="category-card" data-category="gastrointestinal">
                <h2 class="category-title">Gastrointestinal <span class="video-count">2</span></h2>
                
                <h3 class="category-subheader">Normal Anatomy</h3>
                <a href="#" class="video-link" onclick="showHepatobiliaryAnatomy(event)">Colorized Anatomy</a>
                <a href="https://pocus101.b-cdn.net/wp-content/uploads/2020/10/Portal-Triad-Mickey-Mouse-Sign-Portal-Vein-CBD-Right-Hepatic-Artery-Hepatobiliary-Ultrasound-2-1024x715.png" class="video-link" target="_blank">Portal Triad Mickey Mouse View</a>

                <h3 class="category-subheader">Pathology</h3>
                <a href="#" class="video-link" onclick="showCholecystitisMeasurements(event)">Measurements in Cholecystitis</a>
                
                <h3 class="category-subheader">Videos</h3>
                <a href="https://coreultrasound.com/gallbladder/" class="video-link" target="_blank">Gallbladder</a>
            </div>

            <!-- Reproductive Category -->
<div class="category-card" data-category="reproductive">
    <h2 class="category-title">OB/GYN <span class="video-count">3</span></h2>

     <h3 class="category-subheader">Anatomy</h3>
         <a href="#" class="video-link" onclick="showReproductiveAnatomy(event)">Transabdominal View</a>
    
    <h3 class="category-subheader">Scanning Protocols</h3>
    <a href="#" class="video-link" onclick="showFirstTrimesterTable(event)">First Trimester Pregnancy Protocol</a>

     <h3 class="category-subheader">Clinical Applications</h3>
<a href="#" class="video-link" onclick="showGetTwoViewsCase(event)">Get 2 Views!</a>
    
    <h3 class="category-subheader">Videos</h3>
    <a href="https://coreultrasound.com/ob-gyn-scanning-technique-5ms/" class="video-link" target="_blank">Basic Ob-Gyn Scanning Technique</a>
    <a href="https://coreultrasound.com/ntrauterine-pregnancy-assessment-5ms/" class="video-link" target="_blank">Intrauterine Pregnancy Identification</a>
</div>

            <!-- Venous Thromboembolism Category -->
            <div class="category-card" data-category="vte">
                <h2 class="category-title">Venous Thromboembolism <span class="video-count">1</span></h2>
                <a href="https://coreultrasound.com/dvt/" class="video-link" target="_blank">Deep Venous Thrombosis</a>
            </div>
        </div>
    </div>

     <!-- Zine Builder Widget -->
    <div class="zine-widget" id="zineWidget">
        <!-- Toggle Button -->
        <div class="zine-toggle" id="zineToggle">
            Zine<br>Builder
        </div>

        <!-- Expanded Panel -->
        <div class="zine-panel" id="zinePanel">
            <div class="close-btn" id="closeBtn">×</div>
            
            <div class="zine-header">
                <div class="zine-title">Medical Zine Builder</div>
                <div class="zine-subtitle">Create Pocket Reference</div>
            </div>

            <div class="zine-content">
                <!-- Selected Modules Section -->
                <div class="selected-section">
                    <div class="selected-title">Your Zine (<span id="moduleCount">0</span> modules, <span id="pageCount">0</span> pages)</div>
                    <div id="selectedModules">
                        <div style="text-align: center; color: #4B4B4B; font-size: 9px; padding: 10px;">
                            No modules selected
                        </div>
                    </div>
                </div>

                <!-- Emergency Modules -->
                
                <!-- Cardiology Modules -->
                <div class="module-category">
                    <div class="category-title">Cardiology</div>
                    <div class="module-item">
                        <span class="module-name">Echo Measurements</span>
                        <span class="module-pages">1p</span>
                        <div class="module-btn" data-module="echo">+</div>
                    </div>
                    <div class="module-item">
                        <span class="module-name">EKG Interpretation</span>
                        <span class="module-pages">2p</span>
                        <div class="module-btn" data-module="ekg">+</div>
                    </div>
                </div>

                <!-- Ultrasound Modules -->
                <div class="module-category">
                    <div class="category-title">Ultrasound</div>
                    <div class="module-item">
                        <span class="module-name">RUSH Protocol</span>
                        <span class="module-pages">1p</span>
                        <div class="module-btn" data-module="rush">+</div>
                    </div>
                    <div class="module-item">
                        <span class="module-name">Cardiac Views</span>
                        <span class="module-pages">2p</span>
                        <div class="module-btn" data-module="cardiac-views">+</div>
                    </div>
                    <div class="module-item">
                        <span class="module-name">BLUE Protocol</span>
                        <span class="module-pages">1p</span>
                        <div class="module-btn" data-module="blue">+</div>
                    </div>
                </div>

                <!-- Export Section -->
                <div class="export-section">
                    <div class="selected-title">Export Options</div>
                    <button class="export-btn" id="exportLetter">Export US Letter PDF</button>
                    <button class="export-btn" id="exportA4">Export A4 PDF</button>
                    <div style="font-size: 8px; color: #4B4B4B; margin-top: 5px; text-align: center;">
                        Print double-sided, fold in half
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Credits Footer -->
    <footer>
        <p>Powered by Core Ultrasound, NephroPOCUS, MedChiefs, POCUS101, and Show Me The POCUS Resources</p>
    </footer>

    <script>
        // Search functionality only
        const searchBox = document.getElementById('searchBox');

        function performSearch() {
            const searchTerm = searchBox.value.toLowerCase().trim();
            const categoryCards = document.querySelectorAll('.category-card');
            
            if (searchTerm === '') {
                categoryCards.forEach(card => {
                    card.classList.remove('hidden');
                    const links = card.querySelectorAll('.video-link');
                    links.forEach(link => link.classList.remove('hidden'));
                });
                return;
            }

            categoryCards.forEach(card => {
                const categoryTitle = card.querySelector('.category-title').textContent.toLowerCase();
                const links = card.querySelectorAll('.video-link');
                let hasVisibleLinks = false;
                const categoryMatches = categoryTitle.includes(searchTerm);

                links.forEach(link => {
                    const linkText = link.textContent.toLowerCase();
                    if (linkText.includes(searchTerm) || categoryMatches) {
                        link.classList.remove('hidden');
                        hasVisibleLinks = true;
                    } else {
                        link.classList.add('hidden');
                    }
                });

                if (hasVisibleLinks) {
                    card.classList.remove('hidden');
                } else {
                    card.classList.add('hidden');
                }
            });
        }

        // RUSH table function - opens in new tab
        function showRushTable(e) {
            e.preventDefault();
            const tableHTML = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>RUSH Protocol Table</title>
                    <style>
                        body { 
                            font-family: 'Courier New', monospace; 
                            background: #BEBEBE; 
                            margin: 20px; 
                            color: #000000;
                        }
                        .container {
                            background: #BEBEBE; 
                            border: 4px solid #000000; 
                            border-style: outset; 
                            padding: 20px; 
                            max-width: 1000px; 
                            margin: 0 auto;
                        }
                        h2 { 
                            color: #990000; 
                            text-align: center; 
                            margin-bottom: 20px; 
                            text-transform: uppercase; 
                        }
                        h3 { 
                            color: #990000; 
                            margin-bottom: 15px; 
                        }
                        .grid { 
                            display: grid; 
                            grid-template-columns: 1fr 1fr 1fr; 
                            gap: 15px; 
                            font-size: 12px; 
                        }
                        .step { 
                            background: #828282; 
                            border: 2px solid #000000; 
                            border-style: inset; 
                            padding: 15px; 
                        }
                        h4 { 
                            color: #990000; 
                            text-transform: uppercase; 
                            margin-bottom: 10px; 
                        }
                        .section { 
                            margin-bottom: 15px; 
                        }
                        @media (max-width: 768px) {
                            .grid { grid-template-columns: 1fr; }
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <h2>RUSH Protocol Table</h2>
                        <h3>Table 2: Using the RUSH protocol to diagnose the type of shock</h3>
                        
                        <div class="grid">
                            <div class="step">
                                <h4>Step 1: Pump</h4>
                                <div class="section">
                                    <strong>Pericardial effusion:</strong><br>
                                    • Effusion present?<br>
                                    • Signs of tamponade?<br>
                                    • Diastolic collapse of R Vent +/− R Atrium?
                                </div>
                                <div class="section">
                                    <strong>Left ventricular contractility:</strong><br>
                                    • Hyperdynamic?<br>
                                    • Normal?<br>
                                    • Decreased?
                                </div>
                                <div class="section">
                                    <strong>Right ventricular strain:</strong><br>
                                    • Increased size of RV?<br>
                                    • Septal displacement from right to left?
                                </div>
                            </div>
                            
                            <div class="step">
                                <h4>Step 2: Tank</h4>
                                <div class="section">
                                    <strong>Tank volume:</strong><br>
                                    <u>Inferior vena cava:</u><br>
                                    • Large size/small Insp collapse? —CVP high—<br>
                                    • Small size/large Insp collapse? —CVP Low—<br>
                                    <u>Internal jugular veins:</u><br>
                                    • Small or large?
                                </div>
                                <div class="section">
                                    <strong>Tank leakiness:</strong><br>
                                    <u>E-FAST exam:</u><br>
                                    • Free fluid Abd/Pelvis?<br>
                                    • Free fluid thoracic cavity?<br>
                                    <u>Pulm edema:</u><br>
                                    • Lung rockets?
                                </div>
                                <div class="section">
                                    <strong>Tank compromise:</strong><br>
                                    <u>Tension pneumothorax:</u><br>
                                    • Absent lung sliding?<br>
                                    • Absent comet tails?
                                </div>
                            </div>
                            
                            <div class="step">
                                <h4>Step 3: Pipes</h4>
                                <div class="section">
                                    <strong>Abdominal aorta aneurysm:</strong><br>
                                    • Abd aorta > 3 cm?
                                </div>
                                <div class="section">
                                    <strong>Thoracic aorta aneurysm/dissection:</strong><br>
                                    • Aortic root > 3.8 cm?<br>
                                    • Intimal flap?<br>
                                    • Thor aorta > 5 cm?
                                </div>
                                <div class="section">
                                    <strong>Femoral vein DVT:</strong><br>
                                    • Noncompressible vessel?
                                </div>
                                <div class="section">
                                    <strong>Popliteal vein DVT:</strong><br>
                                    • Noncompressible vessel?
                                </div>
                            </div>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            const newWindow = window.open('', '_blank');
            newWindow.document.write(tableHTML);
            newWindow.document.close();
        }

// Hepatobiliary anatomy function - opens in new tab
function showHepatobiliaryAnatomy(e) {
    e.preventDefault();
    const anatomyHTML = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>Hepatobiliary Anatomy - Colorized Ultrasound</title>
            <style>
                body { 
                    font-family: 'Courier New', monospace; 
                    background: #BEBEBE; 
                    margin: 20px; 
                    color: #000000;
                }
                .container {
                    background: #BEBEBE; 
                    border: 4px solid #000000; 
                    border-style: outset; 
                    padding: 20px; 
                    max-width: 1000px; 
                    margin: 0 auto;
                }
                h2 { 
                    color: #990000; 
                    text-align: center; 
                    margin-bottom: 20px; 
                    text-transform: uppercase; 
                }
                .image-container { 
                    background: #828282; 
                    border: 2px solid #000000; 
                    border-style: inset; 
                    padding: 20px; 
                    text-align: center;
                    margin-bottom: 20px;
                }
                .image-container img {
                    max-width: 100%;
                    height: auto;
                    border: 2px solid #000000;
                    margin-bottom: 15px;
                }
                .legend {
                    background: #828282; 
                    border: 2px solid #000000; 
                    border-style: inset; 
                    padding: 20px; 
                }
                .legend-title {
                    color: #990000;
                    font-weight: bold;
                    text-transform: uppercase;
                    margin-bottom: 15px;
                    text-align: center;
                    border-bottom: 2px solid #000000;
                    padding-bottom: 5px;
                }
                .legend-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 10px;
                    font-size: 14px;
                    font-weight: bold;
                }
                .legend-item {
                    display: flex;
                    align-items: center;
                    padding: 8px;
                    background: #BEBEBE;
                    border: 1px solid #000000;
                }
                .color-box {
                    width: 20px;
                    height: 20px;
                    border: 2px solid #000000;
                    margin-right: 10px;
                    flex-shrink: 0;
                }
                .green { background: #00FF00; }
                .blue { background: #0066FF; }
                .orange { background: #FF6600; }
                .pink { background: #FF69B4; }
                .yellow { background: #FFFF00; }
                @media (max-width: 768px) {
                    .legend-grid { grid-template-columns: 1fr; }
                }
            </style>
        </head>
        <body>
            <div class="container">
                <h2>Hepatobiliary Anatomy - Colorized Ultrasound</h2>
                
                <div class="image-container">
                    <img src="https://images.squarespace-cdn.com/content/v1/58118909e3df282037abfad7/1567929662896-OVT3GRVKEE6G5FYO7RDA/gallbladder-and-cbd.gif?format=750w" alt="Colorized hepatobiliary anatomy ultrasound">
                </div>
                
                <div class="legend">
                    <div class="legend-title">Color-Coded Anatomical Structures</div>
                    <div class="legend-grid">
                        <div class="legend-item">
                            <div class="color-box green"></div>
                            <span>Gallbladder</span>
                        </div>
                        <div class="legend-item">
                            <div class="color-box blue"></div>
                            <span>IVC (Inferior Vena Cava)</span>
                        </div>
                        <div class="legend-item">
                            <div class="color-box orange"></div>
                            <span>Portal Vein</span>
                        </div>
                        <div class="legend-item">
                            <div class="color-box pink"></div>
                            <span>Common Bile Duct</span>
                        </div>
                        <div class="legend-item">
                            <div class="color-box yellow"></div>
                            <span>Lumen of Hepatic Vein</span>
                        </div>
                    </div>
                </div>
            </div>
        </body>
        </html>
    `;
    
    const newWindow = window.open('', '_blank');
    newWindow.document.write(anatomyHTML);
    newWindow.document.close();
}

// Cholecystitis measurements function - opens in new tab
function showCholecystitisMeasurements(e) {
    e.preventDefault();
    const tableHTML = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>Cholecystitis - Ultrasound Measurements and Findings</title>
            <style>
                body { 
                    font-family: 'Courier New', monospace; 
                    background: #BEBEBE; 
                    margin: 20px; 
                    color: #000000;
                }
                .container {
                    background: #BEBEBE; 
                    border: 4px solid #000000; 
                    border-style: outset; 
                    padding: 20px; 
                    max-width: 1200px; 
                    margin: 0 auto;
                }
                h2 { 
                    color: #990000; 
                    text-align: center; 
                    margin-bottom: 20px; 
                    text-transform: uppercase; 
                    font-family: 'Impact', 'Arial Black', sans-serif;
                    text-shadow: 2px 2px 0px #000000;
                }
                .section { 
                    background: #828282; 
                    border: 3px solid #000000; 
                    border-style: inset; 
                    padding: 15px; 
                    margin-bottom: 20px;
                }
                .section-title {
                    color: #990000;
                    font-weight: bold;
                    font-size: 1.1rem;
                    margin-bottom: 15px;
                    text-transform: uppercase;
                    border-bottom: 2px solid #000000;
                    padding-bottom: 5px;
                }
                table {
                    width: 100%;
                    border-collapse: collapse;
                    margin-bottom: 10px;
                    font-size: 12px;
                }
                th {
                    background: #39BFC9;
                    color: #000000;
                    font-weight: bold;
                    padding: 10px;
                    border: 2px solid #000000;
                    text-transform: uppercase;
                    text-align: left;
                }
                td {
                    background: #BEBEBE;
                    padding: 10px;
                    border: 1px solid #000000;
                    vertical-align: top;
                }
                .finding {
                    font-weight: bold;
                    color: #000000;
                }
                .measurement {
                    font-family: 'Courier New', monospace;
                    font-weight: bold;
                    color: #990000;
                }
                .priority-high {
                    background: #990000;
                    color: #BEBEBE;
                    padding: 15px;
                    border: 2px solid #000000;
                    margin-bottom: 15px;
                    font-weight: bold;
                }
                .priority-medium {
                    background: #39BFC9;
                    color: #000000;
                    padding: 15px;
                    border: 2px solid #000000;
                    margin-bottom: 15px;
                    font-weight: bold;
                }
                .priority-low {
                    background: #FFD700;
                    color: #000000;
                    padding: 15px;
                    border: 2px solid #000000;
                    margin-bottom: 15px;
                    font-weight: bold;
                }
                @media (max-width: 768px) {
                    table, th, td {
                        font-size: 10px;
                    }
                    .container {
                        padding: 10px;
                        margin: 10px;
                    }
                }
            </style>
        </head>
        <body>
            <div class="container">
                <h2>Cholecystitis - Ultrasound Measurements and Findings</h2>
                
                <div class="priority-high">
                    <strong>MOST SENSITIVE COMBINATION (Look for these first):</strong><br>
                    • Cholelithiasis + obstructing stone in neck/cystic duct<br>
                    • Positive sonographic Murphy's sign
                </div>

                <div class="section">
                    <div class="section-title">Secondary Findings (Strong Supporting Evidence)</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Finding</th>
                                <th>Measurement/Criteria</th>
                                <th>Clinical Significance</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="finding">Wall Thickening</td>
                                <td class="measurement">&gt;3mm</td>
                                <td>Strong indicator of acute cholecystitis when combined with other findings</td>
                            </tr>
                            <tr>
                                <td class="finding">Pericholecystic Fluid</td>
                                <td class="measurement">Any amount around GB</td>
                                <td>Suggests inflammatory process; assess for complications</td>
                            </tr>
                            <tr>
                                <td class="finding">Cystic Artery PSV</td>
                                <td class="measurement">≥30 cm/s</td>
                                <td><strong>95% PPV, 81% accuracy</strong> - highly specific for acute cholecystitis</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <div class="section-title">Sonographic Murphy's Sign Technique</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Technique</th>
                                <th>Positive Result</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="finding">Probe Pressure</td>
                                <td>Apply gentle pressure directly over gallbladder fundus</td>
                                <td>Focal tenderness at GB location</td>
                            </tr>
                            <tr>
                                <td class="finding">Patient Response</td>
                                <td>Ask patient to take deep breath while maintaining pressure</td>
                                <td>Sudden inspiratory arrest due to pain</td>
                            </tr>
                            <tr>
                                <td class="finding">Control Test</td>
                                <td>Move probe to different location and repeat</td>
                                <td>No similar pain response elsewhere</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="priority-low">
                    <strong>LESS SPECIFIC FINDINGS (Supportive but not diagnostic alone):</strong><br>
                    • Gallbladder distension<br>
                    • Sludge
                </div>

                <div class="section">
                    <div class="section-title">Normal vs. Abnormal Measurements</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Normal Range</th>
                                <th>Abnormal (Concerning)</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="finding">GB Wall Thickness</td>
                                <td class="measurement">&lt;3mm</td>
                                <td class="measurement">&gt;3mm</td>
                                <td>Measure at anterior wall; fasting patient preferred</td>
                            </tr>
                            <tr>
                                <td class="finding">GB Length</td>
                                <td class="measurement">7-10cm</td>
                                <td class="measurement">&gt;10cm</td>
                                <td>Distension may indicate outlet obstruction</td>
                            </tr>
                            <tr>
                                <td class="finding">GB Width</td>
                                <td class="measurement">3-4cm</td>
                                <td class="measurement">&gt;4cm</td>
                                <td>Measure at widest point</td>
                            </tr>
                            <tr>
                                <td class="finding">Cystic Artery PSV</td>
                                <td class="measurement">&lt;30 cm/s</td>
                                <td class="measurement">≥30 cm/s</td>
                                <td>Use color/power Doppler to locate vessel</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <div class="section-title">Diagnostic Approach Priority</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Step</th>
                                <th>Assessment</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>1</strong></td>
                                <td>Look for stones + sonographic Murphy's sign</td>
                                <td>If both present → high suspicion for acute cholecystitis</td>
                            </tr>
                            <tr>
                                <td><strong>2</strong></td>
                                <td>Measure wall thickness and assess for pericholecystic fluid</td>
                                <td>Strong supporting evidence if abnormal</td>
                            </tr>
                            <tr>
                                <td><strong>3</strong></td>
                                <td>Perform Doppler assessment of cystic artery</td>
                                <td>PSV ≥30 cm/s provides high specificity</td>
                            </tr>
                            <tr>
                                <td><strong>4</strong></td>
                                <td>Document additional findings (distension, sludge)</td>
                                <td>Supportive but not diagnostic alone</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </body>
        </html>
    `;
    
    const newWindow = window.open('', '_blank');
    newWindow.document.write(tableHTML);
    newWindow.document.close();
}
        
// Reproductive anatomy function - opens in new tab
function showReproductiveAnatomy(e) {
    e.preventDefault();
    const anatomyHTML = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>Reproductive Anatomy - Labeled Ultrasound Images</title>
            <style>
                body { 
                    font-family: 'Courier New', monospace; 
                    background: #BEBEBE; 
                    margin: 20px; 
                    color: #000000;
                }
                .container {
                    background: #BEBEBE; 
                    border: 4px solid #000000; 
                    border-style: outset; 
                    padding: 20px; 
                    max-width: 1400px; 
                    margin: 0 auto;
                }
                h2 { 
                    color: #990000; 
                    text-align: center; 
                    margin-bottom: 20px; 
                    text-transform: uppercase; 
                }
                .images-grid { 
                    display: grid; 
                    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); 
                    gap: 20px; 
                    margin-bottom: 20px;
                }
                .image-container { 
                    background: #828282; 
                    border: 2px solid #000000; 
                    border-style: inset; 
                    padding: 15px; 
                    text-align: center;
                }
                .image-container img {
                    max-width: 100%;
                    height: auto;
                    border: 2px solid #000000;
                    margin-bottom: 10px;
                }
                .image-title {
                    color: #990000;
                    font-weight: bold;
                    text-transform: uppercase;
                    margin-bottom: 10px;
                }
                .structures-list {
                    background: #828282; 
                    border: 2px solid #000000; 
                    border-style: inset; 
                    padding: 20px; 
                    margin-top: 20px;
                }
                .structures-title {
                    color: #990000;
                    font-weight: bold;
                    text-transform: uppercase;
                    margin-bottom: 15px;
                    text-align: center;
                }
                .structures-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                    gap: 10px;
                    font-size: 12px;
                }
                @media (max-width: 768px) {
                    .images-grid { grid-template-columns: 1fr; }
                    .structures-grid { grid-template-columns: 1fr; }
                }
            </style>
        </head>
        <body>
            <div class="container">
                <h2>Reproductive Anatomy - Labeled Ultrasound Images</h2>
                
                <div class="images-grid">
                    <div class="image-container">
                        <div class="image-title">Sagittal View 1</div>
                        <img src="https://prod-images-static.radiopaedia.org/images/65082656/8b9fbd2615992bd5b06b977466c53f07e119ba45ca24f4368f7b3d7953caafc4_gallery.jpeg" alt="Sagittal reproductive anatomy ultrasound">
                    </div>
                    
                    <div class="image-container">
                        <div class="image-title">Sagittal View 2</div>
                        <img src="https://prod-images-static.radiopaedia.org/images/65082657/6401207853de49cbe66edae80476b91d7e5237bda4b9d8806d65bfed29924f6f_big_gallery.jpeg" alt="Sagittal reproductive anatomy ultrasound">
                    </div>
                    
                    <div class="image-container">
                        <div class="image-title">Sagittal View 3</div>
                        <img src="https://prod-images-static.radiopaedia.org/images/65082658/9246560a1d3ab57bcd999c0dd1d3fd3d8cb5354a8c074c2ad7b575e1321f6f64_big_gallery.jpeg" alt="Sagittal reproductive anatomy ultrasound">
                    </div>
                    
                    <div class="image-container">
                        <div class="image-title">Transverse View 1</div>
                        <img src="https://prod-images-static.radiopaedia.org/images/65082659/0c6e33d0212e84fa5ea5c70bccc6b17e92ecda6d40585fff75e62a948a69336c_big_gallery.jpeg" alt="Transverse reproductive anatomy ultrasound">
                    </div>
                    
                    <div class="image-container">
                        <div class="image-title">Transverse View 2</div>
                        <img src="https://prod-images-static.radiopaedia.org/images/65082660/6561c3c6014ed72aa933361376dcb86945a07801e659d36192f48022fbc64898_big_gallery.jpeg" alt="Transverse reproductive anatomy ultrasound">
                    </div>
                    
                    <div class="image-container">
                        <div class="image-title">Ovarian View 1</div>
                        <img src="https://prod-images-static.radiopaedia.org/images/65082661/5ef03fcd753c3a5d6a37e4a0c9063bca03eb29691f07e70d10eaf8f56abb9d92_big_gallery.jpeg" alt="Ovarian anatomy ultrasound">
                    </div>
                    
                    <div class="image-container">
                        <div class="image-title">Ovarian View 2</div>
                        <img src="https://prod-images-static.radiopaedia.org/images/65082662/468ecf9ca9357688598385cc34526989e1c5061902dae9505f5bd4637c745204_big_gallery.jpeg" alt="Ovarian anatomy ultrasound">
                    </div>
                </div>
                
                <div class="structures-list">
                    <div class="structures-title">Labeled Anatomical Structures</div>
                    <div class="structures-grid">
                        <div>1. Fundus of the uterus</div>
                        <div>2. Bladder</div>
                        <div>3. Vagina</div>
                        <div>4. External os of the cervix</div>
                        <div>5. Pouch of Douglas</div>
                        <div>6. Endometrium</div>
                        <div>7. Posterior body of the uterus</div>
                        <div>8. Anterior body of the uterus</div>
                        <div>9. Cervical canal</div>
                        <div>10. Endometrium</div>
                        <div>11. Internal os of the cervix</div>
                        <div>12. External os of the cervix</div>
                        <div>13. Internal os of the cervix</div>
                        <div>14. Vagina</div>
                        <div>15. Gas in the rectum</div>
                        <div>16. Bladder</div>
                        <div>17. Vaginal</div>
                        <div>18. Rectum</div>
                        <div>19. Rectus abdominis muscle</div>
                        <div>20. Gas in bowel</div>
                        <div>21. Ovary</div>
                        <div>22. Ovarian follicle</div>
                    </div>
                </div>
            </div>
        </body>
        </html>
    `;
    
    const newWindow = window.open('', '_blank');
    newWindow.document.write(anatomyHTML);
    newWindow.document.close();
}
        
// First Trimester table function - opens in new tab
function showFirstTrimesterTable(e) {
    e.preventDefault();
    const tableHTML = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>First Trimester Pregnancy Scanning Protocol</title>
            <style>
                body { 
                    font-family: 'Courier New', monospace; 
                    background: #BEBEBE; 
                    margin: 20px; 
                    color: #000000;
                    line-height: 1.3;
                }
                .container {
                    background: #BEBEBE; 
                    border: 4px solid #000000; 
                    border-style: outset; 
                    padding: 20px; 
                    max-width: 1400px; 
                    margin: 0 auto;
                }
                h1 { 
                    color: #990000; 
                    text-align: center; 
                    margin-bottom: 20px; 
                    text-transform: uppercase; 
                    font-family: 'Impact', 'Arial Black', sans-serif;
                    text-shadow: 2px 2px 0px #000000;
                }
                h2 { 
                    color: #990000; 
                    margin: 20px 0 15px 0; 
                    text-transform: uppercase;
                    border-bottom: 2px solid #000000;
                    padding-bottom: 5px;
                }
                .step-container {
                    background: #828282; 
                    border: 3px solid #000000; 
                    border-style: inset; 
                    padding: 15px; 
                    margin-bottom: 20px;
                }
                .step-title {
                    color: #990000;
                    font-weight: bold;
                    font-size: 1.1rem;
                    margin-bottom: 15px;
                    text-transform: uppercase;
                    border-bottom: 1px solid #4B4B4B;
                    padding-bottom: 5px;
                }
                table {
                    width: 100%;
                    border-collapse: collapse;
                    margin-bottom: 15px;
                    font-size: 12px;
                }
                th {
                    background: #39BFC9;
                    color: #000000;
                    font-weight: bold;
                    padding: 8px;
                    border: 2px solid #000000;
                    text-transform: uppercase;
                }
                td {
                    background: #BEBEBE;
                    padding: 8px;
                    border: 1px solid #000000;
                    vertical-align: top;
                }
                .warning-box {
                    background: #990000;
                    color: #BEBEBE;
                    padding: 10px;
                    border: 2px solid #000000;
                    margin: 10px 0;
                    font-weight: bold;
                }
                .critical-box {
                    background: #39BFC9;
                    color: #000000;
                    padding: 10px;
                    border: 2px solid #000000;
                    margin: 10px 0;
                    font-weight: bold;
                }
                .safety-box {
                    background: #FFD700;
                    color: #000000;
                    padding: 10px;
                    border: 2px solid #000000;
                    margin: 10px 0;
                    font-weight: bold;
                }
                @media (max-width: 768px) {
                    table, th, td {
                        font-size: 10px;
                    }
                    .container {
                        padding: 10px;
                        margin: 10px;
                    }
                }
            </style>
        </head>
        <body>
            <div class="container">
                <h1>First Trimester Pregnancy Scanning Protocol</h1>
                <p style="text-align: center; font-weight: bold; margin-bottom: 20px;">(Up to 13 6/7 weeks gestational age)</p>

                <div class="step-container">
                    <div class="step-title">Step 1: Evaluate Uterus and Cervix for Gestational Sac</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Details</th>
                                <th>Clinical Significance</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Uterine evaluation</strong></td>
                                <td>Scan entire uterus systematically</td>
                                <td>Rule out ectopic pregnancy</td>
                            </tr>
                            <tr>
                                <td><strong>Gestational sac identification</strong></td>
                                <td>Look for echogenic rim around fluid collection</td>
                                <td>Small intrauterine fluid collection >99.5% likely to be intrauterine gestational sac</td>
                            </tr>
                            <tr>
                                <td><strong>Location documentation</strong></td>
                                <td>Document precise location within uterus</td>
                                <td>Abnormal locations (cornual, cervical) require referral</td>
                            </tr>
                            <tr>
                                <td><strong>Size assessment</strong></td>
                                <td>Measure if needed, but CRL is preferred for dating</td>
                                <td>Mean gestational sac diameter NOT recommended for due date estimation</td>
                            </tr>
                            <tr>
                                <td><strong>If no sac visible</strong></td>
                                <td>Consider transvaginal approach</td>
                                <td>May be too early or ectopic pregnancy</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="warning-box">
                        KEY WARNING: A small intrauterine fluid collection could rarely represent a "pseudo-gestational sac" associated with ectopic pregnancy
                    </div>
                </div>

                <div class="step-container">
                    <div class="step-title">Step 2: Assess Gestational Sac Contents</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>What to Look For</th>
                                <th>Action Required</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Yolk sac presence</strong></td>
                                <td>Round structure within gestational sac</td>
                                <td>Confirms definitive intrauterine pregnancy</td>
                            </tr>
                            <tr>
                                <td><strong>Yolk sac absence</strong></td>
                                <td>Empty gestational sac</td>
                                <td>May need follow-up scan or serial hCG</td>
                            </tr>
                            <tr>
                                <td><strong>Embryo/fetus identification</strong></td>
                                <td>Echogenic structure attached to yolk sac</td>
                                <td>Proceed to CRL measurement</td>
                            </tr>
                            <tr>
                                <td><strong>Multiple embryos</strong></td>
                                <td>More than one embryo visible</td>
                                <td>Document and refer for detailed evaluation</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2>Definitive Criteria for Intrauterine Pregnancy (IUP)</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Criteria Level</th>
                                <th>Requirements</th>
                                <th>Clinical Significance</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>DEFINITIVE IUP</strong></td>
                                <td>Intrauterine gestational sac containing:<br>• Yolk sac OR<br>• Embryo/fetus with cardiac activity</td>
                                <td>Can confidently rule out ectopic</td>
                            </tr>
                            <tr>
                                <td><strong>Highly Likely IUP</strong></td>
                                <td>Small intrauterine fluid collection with echogenic rim<br>(in absence of ectopic signs)</td>
                                <td>>99.5% likelihood of IUP</td>
                            </tr>
                            <tr>
                                <td><strong>Pregnancy of Unknown Location</strong></td>
                                <td>Positive βhCG + no definitive IUP</td>
                                <td>Requires follow-up/serial monitoring</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="critical-box">
                        <strong>What Does NOT Constitute Definitive IUP:</strong><br>
                        • Gestational sac alone (without yolk sac or embryo)<br>
                        • "Pseudo-gestational sac" (can occur with ectopic pregnancy)<br>
                        • Decidual reaction only<br>
                        • Fluid collection without echogenic rim
                    </div>
                </div>

                <div class="step-container">
                    <div class="step-title">Step 3: Crown-Rump Length (CRL) Measurement</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Technique Component</th>
                                <th>Specific Requirements</th>
                                <th>Why It Matters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Image optimization</strong></td>
                                <td>Embryo/fetus fills most of image space</td>
                                <td>Maximizes measurement accuracy</td>
                            </tr>
                            <tr>
                                <td><strong>Fetal positioning</strong></td>
                                <td>Neutral midsagittal position (later first trimester)</td>
                                <td>Prevents measurement distortion</td>
                            </tr>
                            <tr>
                                <td><strong>Beam alignment</strong></td>
                                <td>Ultrasound beam perpendicular to embryo/fetus</td>
                                <td>Ensures true length measurement</td>
                            </tr>
                            <tr>
                                <td><strong>Caliper placement</strong></td>
                                <td>Outer border of skin from head to rump</td>
                                <td>Standardized measurement technique</td>
                            </tr>
                            <tr>
                                <td><strong>Entire length visible</strong></td>
                                <td>Show complete CRL in image</td>
                                <td>Partial measurements are inaccurate</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="critical-box">
                        <strong>CRL-Based Redating Guidelines:</strong><br>
                        • <8 6/7 weeks: Redate if discrepancy >5 days from LMP<br>
                        • 9 0/7 - 13 6/7 weeks: Redate if discrepancy >7 days from LMP<br><br>
                        <strong>Critical Note:</strong> CRL is the MOST accurate method for pregnancy dating in first trimester
                    </div>
                </div>

                <div class="step-container">
                    <div class="step-title">Step 4: Document Cardiac Activity</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Technique</th>
                                <th>When to Use</th>
                                <th>Avoid</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>M-mode imaging</strong></td>
                                <td>Place M-mode cursor through fetal heart</td>
                                <td>Preferred method</td>
                                <td>Pulsed Doppler in first trimester</td>
                            </tr>
                            <tr>
                                <td><strong>2D video clip</strong></td>
                                <td>Record real-time cardiac motion</td>
                                <td>Alternative to M-mode</td>
                                <td>Using Doppler to "hear" heartbeat</td>
                            </tr>
                            <tr>
                                <td><strong>Timing expectations</strong></td>
                                <td>Usually visible when embryo ≥2mm (transvaginal)</td>
                                <td>Guide expectations</td>
                                <td>Immediate pregnancy termination</td>
                            </tr>
                            <tr>
                                <td><strong>No cardiac activity</strong></td>
                                <td>If embryo <7mm without activity</td>
                                <td>Follow-up scan in 1 week</td>
                                <td>Immediate pregnancy termination</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="safety-box">
                        SAFETY PRIORITY: NEVER use pulsed Doppler in first trimester to hear heartbeat - violates ALARA principle
                    </div>
                </div>

                <div class="step-container">
                    <div class="step-title">Step 5: Examine Adnexa and Cul-de-sac with Free Fluid Assessment</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Anatomical Area</th>
                                <th>What to Assess</th>
                                <th>Document</th>
                                <th>Red Flags</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Right adnexa</strong></td>
                                <td>Ovaries, fallopian tubes</td>
                                <td>Presence, location, appearance, size</td>
                                <td>Masses, complex cysts</td>
                            </tr>
                            <tr>
                                <td><strong>Left adnexa</strong></td>
                                <td>Ovaries, fallopian tubes</td>
                                <td>Any abnormal findings</td>
                                <td>Ectopic pregnancy signs</td>
                            </tr>
                            <tr>
                                <td><strong>Cul-de-sac (Pouch of Douglas)</strong></td>
                                <td>Free fluid presence/absence</td>
                                <td>Amount and characteristics</td>
                                <td>Large amount of free fluid</td>
                            </tr>
                            <tr>
                                <td><strong>Paracolic gutters</strong></td>
                                <td>Extend assessment if fluid seen</td>
                                <td>Document extent</td>
                                <td>Significant hemoperitoneum</td>
                            </tr>
                            <tr>
                                <td><strong>Ovarian findings</strong></td>
                                <td>Corpus luteum, cysts</td>
                                <td>Size and characteristics</td>
                                <td>Suspicious solid components</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2>Free Fluid Assessment Protocol</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Amount of Fluid</th>
                                <th>Clinical Significance</th>
                                <th>Action Required</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>No fluid</strong></td>
                                <td>Normal finding</td>
                                <td>Document absence</td>
                            </tr>
                            <tr>
                                <td><strong>Trace/small amount</strong></td>
                                <td>May be physiologic</td>
                                <td>Document, monitor symptoms</td>
                            </tr>
                            <tr>
                                <td><strong>Moderate amount</strong></td>
                                <td>Concerning, especially with pain</td>
                                <td>Urgent evaluation needed</td>
                            </tr>
                            <tr>
                                <td><strong>Large amount</strong></td>
                                <td>High suspicion for rupture/bleeding</td>
                                <td>Emergency consultation</td>
                            </tr>
                            <tr>
                                <td><strong>Echogenic fluid</strong></td>
                                <td>Suggests blood/debris</td>
                                <td>Immediate physician involvement</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="warning-box">
                        <strong>Critical Clinical Correlations:</strong><br>
                        • Free fluid + no IUP + positive pregnancy test = HIGH suspicion for ectopic pregnancy<br>
                        • Free fluid + adnexal mass + pelvic pain = Possible ovarian torsion or rupture<br>
                        • Large volume free fluid = Potential hemoperitoneum requiring emergency care
                    </div>
                </div>

                <div class="step-container">
                    <div class="step-title">Step 6: Apply ALARA Principle (Safety Requirements)</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Safety Parameter</th>
                                <th>First Trimester Requirement</th>
                                <th>Monitoring</th>
                                <th>Rationale</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Thermal Index</strong></td>
                                <td>TIS (soft tissue) at <10 weeks</td>
                                <td>Ratio must be <0.7</td>
                                <td>Bone not yet ossified</td>
                            </tr>
                            <tr>
                                <td><strong>Thermal Index</strong></td>
                                <td>TIB (bone) at ≥10 weeks</td>
                                <td>Ratio must be <0.7</td>
                                <td>Bone ossification begins</td>
                            </tr>
                            <tr>
                                <td><strong>Scan time</strong></td>
                                <td>Minimize dwell time</td>
                                <td>Keep as short as possible</td>
                                <td>Reduce total exposure</td>
                            </tr>
                            <tr>
                                <td><strong>Power settings</strong></td>
                                <td>Use lowest settings for diagnostic quality</td>
                                <td>Adjust as needed</td>
                                <td>ALARA compliance</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="step-container">
                    <div class="step-title">When Transabdominal Approach is Not Definitive</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Scenario</th>
                                <th>Next Step</th>
                                <th>Reason</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Poor visualization</strong></td>
                                <td>Switch to transvaginal</td>
                                <td>Better resolution in early pregnancy</td>
                            </tr>
                            <tr>
                                <td><strong>Uncertain findings</strong></td>
                                <td>Transvaginal confirmation</td>
                                <td>Higher frequency = better detail</td>
                            </tr>
                            <tr>
                                <td><strong>No intrauterine pregnancy seen</strong></td>
                                <td>Transvaginal scan</td>
                                <td>Rule out very early pregnancy</td>
                            </tr>
                            <tr>
                                <td><strong>Adnexal mass question</strong></td>
                                <td>Transvaginal evaluation</td>
                                <td>Better characterization</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </body>
        </html>
    `;
    
    const newWindow = window.open('', '_blank');
    newWindow.document.write(tableHTML);
    newWindow.document.close();
}

        
        // 5 E's table function - opens in new tab
        function show5EsTable(e) {
            e.preventDefault();
            const tableHTML = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>5 E's Cardiac Ultrasound Table</title>
                    <style>
                        body { 
                            font-family: 'Courier New', monospace; 
                            background: #BEBEBE; 
                            margin: 20px; 
                            color: #000000;
                        }
                        .container {
                            background: #BEBEBE; 
                            border: 4px solid #000000; 
                            border-style: outset; 
                            padding: 20px; 
                            max-width: 1200px; 
                            margin: 0 auto;
                        }
                        h2 { 
                            color: #990000; 
                            text-align: center; 
                            margin-bottom: 20px; 
                            text-transform: uppercase; 
                        }
                        h3 { 
                            color: #990000; 
                            margin-bottom: 15px; 
                        }
                        .grid { 
                            display: grid; 
                            grid-template-columns: 1fr 1fr 1fr 1fr 1fr; 
                            gap: 15px; 
                            font-size: 11px; 
                        }
                        .step { 
                            background: #828282; 
                            border: 2px solid #000000; 
                            border-style: inset; 
                            padding: 15px; 
                        }
                        h4 { 
                            color: #990000; 
                            text-transform: uppercase; 
                            margin-bottom: 10px; 
                            font-size: 12px;
                        }
                        .section { 
                            margin-bottom: 12px; 
                        }
                        .category { 
                            color: #990000; 
                            font-weight: bold; 
                            margin-bottom: 5px; 
                        }
                        .findings { 
                            margin-bottom: 8px; 
                        }
                        .additional { 
                            color: #000080; 
                            font-size: 10px; 
                        }
                        @media (max-width: 1024px) {
                            .grid { grid-template-columns: 1fr 1fr; }
                        }
                        @media (max-width: 768px) {
                            .grid { grid-template-columns: 1fr; }
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <h2>5 E's Cardiac Ultrasound Protocol</h2>
                        <h3>Table 1: Explanation of the 5Es</h3>
                        
                        <div class="grid">
                            <div class="step">
                                <h4>1. Effusion</h4>
                                <div class="section">
                                    <div class="category">Categorization of Findings</div>
                                    <div class="findings">
                                        • None (trace)<br>
                                        • Small (&lt;1 cm)<br>
                                        • Moderate (1-2 cm)<br>
                                        • Large (&gt;2 cm)
                                    </div>
                                </div>
                                <div class="section">
                                    <div class="category">Additional Findings</div>
                                    <div class="additional">
                                        • Tamponade physiology<br>
                                        • RV free wall collapse in diastole (may use M-mode)<br>
                                        • RA collapse in ventricular systole<br>
                                        • 25% respirophasic variation in peak velocity using spectral Doppler<br>
                                        • Plethoric IVC
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step">
                                <h4>2. Ejection</h4>
                                <div class="section">
                                    <div class="category">Categorization of Findings</div>
                                    <div class="findings">
                                        • Hyperdynamic (EF &gt; 65%)<br>
                                        • Normal (EF 50%-65%)<br>
                                        • Moderately depressed (EF 30%-50%)<br>
                                        • Severely depressed (EF &lt; 30%)<br>
                                        • No significant myocardial activity
                                    </div>
                                </div>
                                <div class="section">
                                    <div class="category">Additional Findings</div>
                                    <div class="additional">
                                        • E-point septal separation &lt; 7 mm is normal<br>
                                        • LV diameter &gt; 6 cm in diastole is abnormal<br>
                                        • Wall motion abnormalities using "SALPI" mnemonic (septal, anterior, lateral, posterior, inferior) on short-axis view
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step">
                                <h4>3. Equality</h4>
                                <div class="section">
                                    <div class="category">Categorization of Findings</div>
                                    <div class="findings">
                                        • Normal (RV:LV &lt; 1)<br>
                                        • Enlarged (RV:LV ≥ 1)
                                    </div>
                                </div>
                                <div class="section">
                                    <div class="category">Additional Findings</div>
                                    <div class="additional">
                                        • Other signs of RV strain:<br>
                                        &nbsp;&nbsp;○ Septal bowing (D-shaped septum)<br>
                                        &nbsp;&nbsp;○ McConnell's sign<br>
                                        &nbsp;&nbsp;○ Elevated RV pressure estimated using continuous wave Doppler with peak TR<br>
                                        &nbsp;&nbsp;○ Tricuspid annular plane systolic excursion (TAPSE) &lt; 16 mm<br>
                                        • Beware chronic RV strain (COPD, pulmonary hypertension)<br>
                                        &nbsp;&nbsp;○ RV free wall thickness &gt; 5 mm<br>
                                        &nbsp;&nbsp;○ TR jet very elevated (&gt;4 m/sec)<br>
                                        &nbsp;&nbsp;○ Absent McConnell's sign
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step">
                                <h4>4. Exit</h4>
                                <div class="section">
                                    <div class="category">Categorization of Findings</div>
                                    <div class="findings">
                                        • Normal root (&lt;4 cm)<br>
                                        • Borderline root (4-4.5 cm)<br>
                                        • TAA (&gt;4.5 cm)
                                    </div>
                                </div>
                                <div class="section">
                                    <div class="category">Additional Findings</div>
                                    <div class="additional">
                                        • Dissection flap<br>
                                        • Aortic regurgitation using color Doppler<br>
                                        • Pericardial effusion
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step">
                                <h4>5. Entrance</h4>
                                <div class="section">
                                    <div class="category">Categorization of Findings</div>
                                    <div class="findings">
                                        • Flat IVC (&lt;1 cm, &gt; 75% collapse)<br>
                                        • Normal collapse<br>
                                        • Full IVC (&gt;2 cm, &lt; 25% collapse)
                                    </div>
                                </div>
                                <div class="section">
                                    <div class="category">Additional Findings</div>
                                    <div class="additional">
                                        • Can use M-mode to calculate caval index:<br>
                                        &nbsp;&nbsp;max IVC diameter - min IVC diameter<br>
                                        &nbsp;&nbsp;÷ max IVC diameter<br>
                                        • Measurements within 1-2 cm of hepatic vein
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 20px; font-size: 10px; color: #666;">
                            <strong>Abbreviations:</strong> COPD = chronic obstructive pulmonary disease; EF = ejection fraction; IVC = inferior vena cava; LA = left atrium; LV = left ventricle; RA = right atrium; RV = right ventricle; TAA = thoracic aortic aneurysm; TR = tricuspid regurgitation.
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            const newWindow = window.open('', '_blank');
            newWindow.document.write(tableHTML);
            newWindow.document.close();
        }

        // Get Two Views case function - opens in new tab
function showGetTwoViewsCase(e) {
    e.preventDefault();
    const caseHTML = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>Get Two Views - Teaching Case</title>
            <style>
    body { 
        font-family: 'Courier New', monospace; 
        background: #BEBEBE; 
        margin: 10px; 
        color: #000000;
        padding: 0;
    }
    .container {
        background: #BEBEBE; 
        border: 4px solid #000000; 
        border-style: outset; 
        padding: 15px; 
        max-width: 1200px; 
        margin: 0 auto;
    }
    h2 { 
        color: #990000; 
        text-align: center; 
        margin-bottom: 20px; 
        text-transform: uppercase; 
        font-size: 1.5rem;
    }
    .grid { 
        display: grid; 
        grid-template-columns: 1fr 1fr; 
        gap: 15px; 
    }
    .view { 
        background: #828282; 
        border: 2px solid #000000; 
        border-style: inset; 
        padding: 10px; 
        text-align: center;
    }
    h3 { 
        color: #990000; 
        margin-bottom: 10px; 
        text-transform: uppercase;
        font-size: 0.9rem;
    }
    img {
        max-width: 100%;
        height: auto;
        border: 2px solid #000000;
        max-height: 40vh;
        object-fit: contain;
    }
    @media (max-width: 768px) {
        body { margin: 5px; }
        .container { padding: 10px; border-width: 2px; }
        .grid { 
            grid-template-columns: 1fr; 
            gap: 10px;
        }
        .view { padding: 8px; }
        h2 { font-size: 1.2rem; margin-bottom: 15px; }
        h3 { font-size: 0.8rem; margin-bottom: 8px; }
        img {
            max-height: 35vh;
        }
    }
    @media (max-width: 480px) {
        .container { padding: 8px; }
        .view { padding: 6px; }
        h2 { font-size: 1rem; }
        h3 { font-size: 0.75rem; }
        img {
            max-height: 30vh;
        }
    }
</style>
        </head>
        <body>
            <div class="container">
                <h2>Get Two Views - Teaching Case</h2>
                
                <div class="grid">
                    <div class="view">
                        <h3>Transabdominal Longitudinal View</h3>
                        <img src="https://images.squarespace-cdn.com/content/v1/5c69e7d7b91449698da66e65/d2a6094b-1b67-4f95-9e8c-592994888e08/IUP.Heterotopic.ezgif.gif?format=2500w" alt="Transabdominal Longitudinal View">
                    </div>
                    
                    <div class="view">
                        <h3>Transverse View</h3>
                        <img src="https://images.squarespace-cdn.com/content/v1/5c69e7d7b91449698da66e65/c4546ac7-8369-4e71-ad14-d0341f9fc5f0/R.sided.heterotopic.ezgif.gif?format=2500w" alt="Transverse View">
                    </div>
                    
                    <div class="view">
                        <h3>Right Adnexa</h3>
                        <img src="https://images.squarespace-cdn.com/content/v1/5c69e7d7b91449698da66e65/7eddf449-edcb-4b27-881b-46dce9c4e96a/R.yolk%3F%3F%3F.ezgif.gif?format=2500w" alt="Right Adnexa">
                    </div>
                    
                    <div class="view">
                        <h3>Right Upper Quadrant</h3>
                        <img src="https://images.squarespace-cdn.com/content/v1/5c69e7d7b91449698da66e65/dd4e01d5-d3ae-43d6-91d1-2f2d8b3ff69c/hemoperitoneum.ezgif.gif?format=2500w" alt="Right Upper Quadrant">
                    </div>
                </div>
            </div>
        </body>
        </html>
     `;
    
    const newWindow = window.open('', '_blank');
    newWindow.document.write(caseHTML);
    newWindow.document.close();
}
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            searchBox.addEventListener('input', performSearch);
        });
    </script>

    <!-- Load jsPDF from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <script>
        // Medical module data
        const modules = {
            acls: { title: 'ACLS Protocol', pages: 2, content: 'VF/VT Algorithm: Shock 120-200J, CPR 2min, Epinephrine 1mg q3-5min, Amiodarone 300mg then 150mg. Asystole/PEA: CPR 2min, Epinephrine 1mg q3-5min, consider H\'s & T\'s.' },
            stroke: { title: 'Stroke Assessment', pages: 1, content: 'NIHSS: 0-4 minor, 5-15 moderate, 16-20 mod-severe, 21-42 severe. tPA criteria: 18-80y, <4.5hrs, no hemorrhage, NIHSS 4-25.' },
            sepsis: { title: 'Sepsis Protocol', pages: 1, content: 'qSOFA (≥2): RR≥22, altered mental status, SBP≤100. 3hr bundle: lactate, cultures, antibiotics, 30mL/kg fluids if hypotensive.' },
            echo: { title: 'Echo Measurements', pages: 1, content: 'Normal values: LVEF >55%, LVEDD 3.9-5.3cm, LVESD 2.2-3.6cm(M)/2.2-3.1cm(F). Aortic valve: peak velocity <2.0m/s, area >3.0cm².' },
            ekg: { title: 'EKG Interpretation', pages: 2, content: 'Systematic approach: Rate (300/RR), rhythm, intervals (PR 120-200ms, QRS <120ms, QT <440ms(M)/<460ms(F)). STEMI: ≥1mm ST elevation in 2+ contiguous leads.' },
            rush: { title: 'RUSH Protocol', pages: 1, content: 'Pump: pericardial effusion, LV function, RV strain. Tank: IVC size, free fluid, pneumothorax. Pipes: AAA, aortic dissection, DVT.' },
            'cardiac-views': { title: 'Cardiac Views', pages: 2, content: 'Standard views: Parasternal long/short, apical 4/5 chamber, subxiphoid, IVC. Assess wall motion using SALPI mnemonic (septal, anterior, lateral, posterior, inferior).' },
            blue: { title: 'BLUE Protocol', pages: 1, content: 'Lung ultrasound: Normal A-lines, B-lines (pulmonary edema), consolidation (pneumonia), absent sliding (pneumothorax). BLUE points for systematic scanning.' },
            dosing: { title: 'Emergency Dosing', pages: 2, content: 'CV: Metoprolol 25-100mg BID PO/2.5-5mg IV, Lisinopril 2.5-40mg daily, Furosemide 20-80mg daily PO/20-40mg IV. Pain: Morphine 2-10mg IV q2-4h.' }
        };

        let selectedModules = [];

        // DOM elements
        const zineToggle = document.getElementById('zineToggle');
        const zinePanel = document.getElementById('zinePanel');
        const closeBtn = document.getElementById('closeBtn');
        const moduleCount = document.getElementById('moduleCount');
        const pageCount = document.getElementById('pageCount');
        const selectedModulesDiv = document.getElementById('selectedModules');
        const exportLetterBtn = document.getElementById('exportLetter');
        const exportA4Btn = document.getElementById('exportA4');

        // Toggle panel
        zineToggle.addEventListener('click', () => {
            zinePanel.classList.toggle('expanded');
        });

        closeBtn.addEventListener('click', () => {
            zinePanel.classList.remove('expanded');
        });

        // Module selection
        document.querySelectorAll('.module-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const moduleId = btn.getAttribute('data-module');
                const module = modules[moduleId];
                
                if (btn.classList.contains('added')) {
                    // Remove module
                    selectedModules = selectedModules.filter(m => m.id !== moduleId);
                    btn.textContent = '+';
                    btn.classList.remove('added');
                } else {
                    // Add module
                    selectedModules.push({ id: moduleId, ...module });
                    btn.textContent = '−';
                    btn.classList.add('added');
                }
                
                updateSelectedDisplay();
            });
        });

        // Update selected modules display
        function updateSelectedDisplay() {
            const totalPages = selectedModules.reduce((sum, m) => sum + m.pages, 0);
            
            moduleCount.textContent = selectedModules.length;
            pageCount.textContent = totalPages;
            
            if (selectedModules.length === 0) {
                selectedModulesDiv.innerHTML = '<div style="text-align: center; color: #4B4B4B; font-size: 9px; padding: 10px;">No modules selected</div>';
                exportLetterBtn.classList.add('disabled');
                exportA4Btn.classList.add('disabled');
            } else {
                selectedModulesDiv.innerHTML = selectedModules.map(module => `
                    <div class="selected-item">
                        <span class="selected-name">${module.title}</span>
                        <div class="remove-btn" data-remove="${module.id}">×</div>
                    </div>
                `).join('');
                
                exportLetterBtn.classList.remove('disabled');
                exportA4Btn.classList.remove('disabled');
                
                // Add remove functionality
                document.querySelectorAll('[data-remove]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const moduleId = btn.getAttribute('data-remove');
                        selectedModules = selectedModules.filter(m => m.id !== moduleId);
                        
                        // Update main button
                        const mainBtn = document.querySelector(`[data-module="${moduleId}"]`);
                        if (mainBtn) {
                            mainBtn.textContent = '+';
                            mainBtn.classList.remove('added');
                        }
                        
                        updateSelectedDisplay();
                    });
                });
            }
        }

        // PDF Generation
        function generatePDF(paperSize) {
            if (selectedModules.length === 0) return;
            
            try {
                const { jsPDF } = window.jspdf;
                
                // Paper dimensions
                const dimensions = {
                    letter: { width: 215.9, height: 279.4 },
                    a4: { width: 210, height: 297 }
                };
                
                const { width, height } = dimensions[paperSize];
                const pdf = new jsPDF({ orientation: 'portrait', unit: 'mm', format: [width, height] });
                
                // Layout settings
                const margin = 10;
                const zineWidth = (width - (margin * 2)) / 2 - 5;
                const lineHeight = 4;
                let currentY = margin + 10;
                let currentColumn = 0;
                
                // Helper function
                const addText = (text, fontSize = 10, isBold = false) => {
                    pdf.setFontSize(fontSize);
                    pdf.setFont('helvetica', isBold ? 'bold' : 'normal');
                    
                    const lines = pdf.splitTextToSize(text, zineWidth);
                    
                    for (let line of lines) {
                        if (currentY + lineHeight > margin + height - 20) {
                            if (currentColumn === 0) {
                                currentColumn = 1;
                                currentY = margin + 10;
                            } else {
                                pdf.addPage();
                                currentColumn = 0;
                                currentY = margin + 10;
                            }
                        }
                        
                        const xPosition = currentColumn === 0 ? margin : margin + zineWidth + 10;
                        pdf.text(line, xPosition, currentY);
                        currentY += lineHeight;
                    }
                };
                
                // Title
                addText('MEDICAL REFERENCE ZINE', 14, true);
                currentY += 6;
                addText(`Generated: ${new Date().toLocaleDateString()}`, 8);
                currentY += 8;
                
                // Add modules
                selectedModules.forEach((module, index) => {
                    currentY += 4;
                    addText(module.title.toUpperCase(), 11, true);
                    currentY += 2;
                    addText(module.content, 9);
                    
                    if (index < selectedModules.length - 1) {
                        currentY += 4;
                        const xPosition = currentColumn === 0 ? margin : margin + zineWidth + 10;
                        pdf.setDrawColor(200, 200, 200);
                        pdf.line(xPosition, currentY, xPosition + zineWidth, currentY);
                        currentY += 3;
                    }
                });
                
                // Add fold guide
                pdf.setDrawColor(150, 150, 150);
                pdf.setLineDashPattern([2, 2], 0);
                pdf.line(width/2, 0, width/2, height);
                
                // Save
                const filename = `medical-zine-${paperSize}-${new Date().toISOString().split('T')[0]}.pdf`;
                pdf.save(filename);
                
            } catch (error) {
                alert('PDF generation failed. Please try again or check your internet connection.');
                console.error('PDF error:', error);
            }
        }

        // Export button events
        exportLetterBtn.addEventListener('click', () => {
            if (!exportLetterBtn.classList.contains('disabled')) {
                generatePDF('letter');
            }
        });

        exportA4Btn.addEventListener('click', () => {
            if (!exportA4Btn.classList.contains('disabled')) {
                generatePDF('a4');
            }
        });

        // Close panel when clicking outside
        document.addEventListener('click', (e) => {
            if (!document.getElementById('zineWidget').contains(e.target)) {
                zinePanel.classList.remove('expanded');
            }
        });

        // Initial display update
        updateSelectedDisplay();    
    </script>
<img src="https://hitscounter.dev/api/hit?url=https%3A%2F%2Fchristiantreat.github.io%2Fsonowolf%2F&label=visits+%2F+total&icon=share&color=%23ffffff&message=&style=flat-square&tz=UTC">
</body>    
</html>
